<!doctype html>
<html lang="en" data-theme="{{ current_theme }}" data-theme-options='{{ theme_options|tojson }}'>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}ML Server AIO{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/core.css') }}">
    {% block styles %}{% endblock %}
  </head>
  <body>
    <a class="skip-link" href="#main">Skip to main content</a>
    <header class="site-header" role="banner">
      <div class="shell">
        <div class="brand">
          <a class="brand__link" href="{{ url_for('home', theme=current_theme) }}">
            <span class="brand__logo" aria-hidden="true">
              <img src="{{ url_for('static', filename='img/ml_server_icon.png') }}" alt="">
            </span>
            <span class="brand__text">
              <span class="brand__title">ML Server All-In-One</span>
              <span class="brand__subtitle">Offline ML Toolkit</span>
            </span>
          </a>
        </div>
        <button class="nav-toggle" type="button" data-nav-toggle aria-expanded="false" aria-controls="primary-nav">
          <span class="nav-toggle__label">Menu</span>
        </button>
        <nav id="primary-nav" class="site-nav" aria-label="Primary" data-nav-menu>
          <ul class="nav-list">
            <li class="nav-list__item"><a class="nav-list__link" data-keep-theme href="{{ url_for('home', theme=current_theme) }}">Home</a></li>
            {% for plugin in nav_plugins %}
              <li class="nav-list__item">
                <a class="nav-list__link" data-keep-theme href="{{ url_for(plugin.blueprint ~ '.index', theme=current_theme) }}">{{ plugin.title }}</a>
              </li>
            {% endfor %}
            {% if help_overview %}
              <li class="nav-list__item"><a class="nav-list__link" data-keep-theme href="{{ help_overview }}{% if '?' in help_overview %}&{% else %}?{% endif %}theme={{ current_theme }}">Help</a></li>
            {% endif %}
          </ul>
        </nav>
        <form class="theme-picker" data-theme-selector>
          <label class="sr-only" for="site-theme">Select theme</label>
          <span aria-hidden="true" class="theme-picker__label">Theme</span>
          <select id="site-theme" name="theme" data-theme-toggle>
            {% for theme_key, theme_meta in theme_options.items() %}
              <option value="{{ theme_key }}" {% if theme_key == current_theme %}selected{% endif %}>{{ theme_meta.label or theme_key|title }}</option>
            {% endfor %}
          </select>
        </form>
      </div>
    </header>
    <div class="global-status" role="status" aria-live="polite" aria-atomic="true">
      {% with messages = get_flashed_messages(with_categories=True) %}
        {% if messages %}
          <ul class="toast-list">
            {% for category, message in messages %}
              <li class="toast toast--{{ category }}">{{ message }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      {% endwith %}
    </div>
    <main id="main" class="site-main" tabindex="-1">
      {% block content %}{% endblock %}
    </main>
    <section class="log-window" data-log-window data-state="collapsed" aria-label="Activity log">
      <header class="log-window__header">
        <button class="log-window__toggle" type="button" data-log-toggle aria-expanded="false">
          <span class="log-window__icon" aria-hidden="true">⌘</span>
          <span class="log-window__title">Activity log</span>
        </button>
        <div class="log-window__actions">
          <button class="log-window__action" type="button" data-log-clear>Clear</button>
        </div>
      </header>
      <ol class="log-window__list" data-log-list></ol>
      <p class="log-window__empty" data-log-empty>No recent activity yet.</p>
    </section>
    <footer class="site-footer" role="contentinfo">
      <div class="shell">
        <p class="site-footer__tagline">{{ site_settings.description or 'Offline only · Privacy first · Built for labs' }}</p>
        <p class="site-footer__meta">&copy; {{ site_settings.name or 'ML Server AIO' }} · {{ config.get('ENV', 'Offline sandbox') }}</p>
      </div>
    </footer>
    <script src="{{ url_for('static', filename='js/core.js') }}" type="module"></script>
    {% block scripts %}{% endblock %}
  </body>
</html>
